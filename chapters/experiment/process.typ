#import "../../define.typ": *
== 流程一致性实验 <exp:rq2>

=== 实验设置与数据筛选

本实验旨在评估工具在动态交互过程中检测流程逻辑异常的能力。实验最初从 80 个目标应用中采集了 160 套设计稿流程，考虑到部分应用界面更新频繁或包含难以自动化的复杂交互（如验证码、外部支付跳转等），为验证过程的可复现性与稳定性，最终筛选并保留了其中 100 个结构稳定、交互路径明确的设计稿作为测试集。

依据先前实证研究 @xiong2023empirical @hu2024auitestagent @liu2024vision 的总结，移动应用中导致屏幕跳转错误的根本原因主要包括：
(i) *资源引用错误*：代码中错误的资源 ID 导致事件侦听器绑定到了错误的 UI 控件上；
(ii) *状态同步缺失*：应用的全局状态（如登录态、数据提交状态）未及时更新，导致逻辑分支错误；
(iii) *事件拦截冲突*：父容器或相邻层级的控件错误地拦截了触摸事件，使得目标控件无法响应。

基于上述理论分析，本实验设计了一套自动化变异策略以模拟真实的流程缺陷。针对测试集中的每一条流程，随机选择一个状态转移步骤 $chevron.l screen_(t a r), d e s c, screen_(t a r) chevron.r$ 进行变异注入。具体的变异模式设计如下：

+ *目标状态变异（Target Mutation，模拟状态回退）：* 篡改应用执行逻辑，使其在应当跳转至新界面 $screen_(t a r)$ 时，错误地返回或停留在前一界面 $screen_(s r c)$。这种情形通常模拟了因网络请求通过失败或本地数据未同步而导致的状态更新失败（例如，用户提交表单后本应进入“成功页”，却因提交失败逻辑被错误引导回“填写页”）。
+ *源动作变异（Source Mutation，模拟交互错位）：* 更改动作执行的目标对象，将原本应作用于目标控件的操作错误地绑定到界面上的其他控件。此类变异模拟了开发过程中常见的 ID 错配或事件绑定混淆（例如，本该点击“下一步”按钮，实际代码却触发了相邻的“取消”按钮或“详情”链接）。

实验环境部署于 Linux 平台的 Waydroid @waydroid 容器中，该环境提供了一个轻量级且可控的 Android 运行时。所有的交互操作均通过 UiAutomator2 @uiautomator2 框架与 Android Debug Bridge (ADB) 接口自动化驱动。实验遵循 @img:process-inconsistency 所示的标准工作流，重点考察系统是否能在变异发生点准确识别出屏幕跳转异常并及时中止流程。

=== 实验结果分析

实验结果显示，本方法在全部 100 个变异测试用例中均成功检测到了异常，精确率（Precision）与召回率（Recall）均达到了 100\%。这一结果表明，基于屏幕相似度阈值$epsilon_(s c r e e n)$的判定机制能够有效地捕捉到由逻辑错误导致的界面错位。

+ *检测的准确性：* 无论是状态回退导致的界面停滞，还是交互错位引发的非预期跳转（如跳入错误的子页面），其产生的实际界面结果与设计稿预期的目标界面 $screen_t a r$ 在视觉结构与内容上均存在显著差异。实验选定的相似度阈值成功区分了这些差异与正常的渲染微变，验证了所选阈值的有效性。
+ *性能分析：* 在执行效率方面，单次屏幕跳转检测的中位耗时为 0.193 秒。该时间开销相较于移动应用自身的页面加载、网络请求及 UI 渲染延迟（通常在秒级）几乎可以忽略不计。这表明该工具完全能够集成到自动化测试流水线中，而不会成为执行效率的瓶颈。

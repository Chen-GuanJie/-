#import "@preview/modern-sjtu-thesis:0.5.1": *

== 原型元模型与一致性检查<app:meta-model>
#imagex(
  image(
    "../../figures/metamodel.pdf",
    width: 80%,
  ),
  caption: [设计设计稿的元模型],
  caption-en: [The meta-model of design mock-ups],
  label-name: "meta-model",
)

如 @img:meta-model 所示，该元模型旨在形式化描述移动应用的设计结构与交互逻辑，其核心架构由四个关键要素构成：流程（process）、界面（screen）、组件（widget）以及操作（action）。这四个要素共同确立了从宏观业务流转到微观交互细节的完整描述体系。

流程体现了应用的业务逻辑主线。每一个流程均拥有一个唯一的入口界面（Start Screen）以及至少一个出口界面（End Screen）。从图论的角度来看，一个完整的业务流程可被建模为一个有向连通图（Directed Connected Graph），其中节点映射为具体的应用界面，而有向边则代表连接不同界面的用户操作行为。值得注意的是，该有向图允许存在环路结构，即起始界面与结束界面可能重合，或者流程中包含返回先前界面的路径，这对应了诸如“用户浏览详情后返回列表”或“循环操作”等常见的交互场景。

界面是承载可视化信息的容器，而组件则是依附于界面之上的最小交互单元，操作（Action）始终作用于界面中的特定组件之上。本元模型定义了涵盖主流移动端交互行为的操作空间，具体包括：点击（click）、长按（long press）、文本输入（send keys）、滚动（scroll）、滑动（swipe）、拖拽（drag and drop）以及系统级的返回操作（go back）。

当用户在特定组件上触发上述任一操作时，系统状态将发生变迁，结果可归纳为以下三种情形：
（i）*状态内演变*，即操作仅改变当前界面的局部状态而不触发跳转；
（ii）*流程内流转*，即操作导致当前视图切换至同一业务流程内的另一个界面节点；或
（iii）*跨流程跳转*，即操作触发了从当前业务流程向另一个独立业务流程的迁移。

此外，为了确保设计规范的一致性与可验证性，GUIPilot 引入了严格的元模型校验机制。如果输入的设计稿违反了上述结构定义或约束条件，系统将自动抛出编译级错误，从工具层面阻断违规输入，并提供详细的错误信息以辅助设计人员对设计稿进行修正与完善。

